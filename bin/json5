#!/usr/bin/env node

var ArgumentParser = require('argparse').ArgumentParser,
    fs = require('fs'),
    JSON5 = require('../json5');

var parser = new ArgumentParser({
        description: 'Converts JSON5 to JSON.  Reads from stdin by default.\nUsage: $0 [file]'
    }),
    args = parser.parseArgs(),
    json5Input = '',
    inputStream;

console.dir(process.argv);
process.argv.length === 1 ? (inputStream = process.stdin).resume() : inputStream = fs.createReadStream(process.argv[1]);

// TODO: Is always using UTF8 for input/output desirable?
inputStream.on('data', function (data) {
    json5Input += data;
});
inputStream.on('end', function () {
    process.stdout.write(JSON.stringify(JSON5.parse(json5Input)));
});
